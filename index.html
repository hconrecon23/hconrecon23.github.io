<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>EASM 游</title>

		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		<link rel="stylesheet" href="dist/reset.css">
		<link rel="stylesheet" href="dist/reveal.css">
		<link rel="stylesheet" href="dist/theme/black.css" id="theme">
		<link rel="stylesheet" href="dist/custom.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="plugin/highlight/monokai.css">
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
				<section>
					<h1>EASM - A deep 游 </h1>
					<h4>https://hconrecon23.github.io</h4>
				</section>
				<section>
					<h1>WHOAMI</h1>
					<h3>SIX2DEZ</h3>
					<img src="profile_pic.jpg" style="border-radius:50%;width:20%;"/>
					<ul>
						<li style="font-size: 0.7em;">Padre, ethical hacker y bash lover en <img style="vertical-align: middle;width: 4em;margin: 0px;" data-src="visma_logo.png">  Red Team</li>
						<li style="font-size: 0.7em;">Pentester en Cobalt Core y bug hunter</li>
						<li style="font-size: 0.7em;">Principales proyectos FOSS: <a href="https://github.com/six2dez/reconftw">reconFTW</a>, <a href="https://github.com/six2dez/OneListForAll">OneListForAll</a>, <a href="https://pentestbook.six2dez.com/">pentest-book</a></li>
						<li style="font-size: 0.7em;">Escalada, senderismo y cualquier cosa relacionada con la monta침a</li>
						<li style="font-size: 0.7em;"><a href="https://twitter.com/six2dez1">@six2dez1</a> en Twitter, <a href="https://github.com/six2dez">@six2dez</a> en el resto</li>
					</ul>
				</section>
				<section>
					<h1>WHOAMI</h1>
					<h3>joohoi</h3>
          			<img src="joohoi_profile.jpg" style="border-radius:50%;width: 20%;" /><br />
					<ul>
						<li>Team lead <img style="vertical-align: middle;width: 4em;margin: 0px;" data-src="visma_logo.png"> red team</li>
						<li>Proyectos open source: <strong>acme-dns</strong>, <strong>ffuf</strong>, <strong>certbot</strong></li>
						<li>Padre, geek de los juegos de mesa, cervecero</li>
						<li><a href="https://twitter.com/joohoi">@joohoi</a> en todos las RRSS</li>
					</ul>
        		</section>
				<section>
					<h2>Eligiendo el objetivo</h2>
					<section>
						<p style="font-size: 0.7em;">(a.k.a. correlaci칩n horizontal)</p>
						<img src="https://media.giphy.com/media/3zDdFSPALuCe6C43nM/giphy.gif" width="60%" height="auto"/>
					</section>
					<section>
						<h4>
							Informaci칩n b치sica 1/2
						</h4>
						<ul>
							<li style="font-size: 0.7em;">Vistazo inicial a la web corporativa
								<ul>
									<li style="font-size: 0.8em;">Sobre nosotros</li>
									<li style="font-size: 0.8em;">Contacto</li>
								</ul>
							</li>
							<li style="font-size: 0.7em;"><a href="https://www.exploit-db.com/google-hacking-database">Google</a>/<a href="https://github.com/techgaun/github-dorks/blob/master/github-dorks.txt">Github</a> Dorks</li>
							<li style="font-size: 0.7em;">Emails, usuarios, tecnolog칤as
								<ul>
									<li style="font-size: 0.8em;">Metadatos en documentos indexados</li>
									<li style="font-size: 0.8em;">Cuentas en redes sociales</li>
								</ul>
							</li>
							<li style="font-size: 0.7em;">Brechas de datos</li>
						</ul>
						<aside class="notes">
							metafinder<br>
							emailfinder<br>
							https://breachdirectory.org/ + https://hashes.com/en/decrypt/hash
						</aside>
					</section>
					<section>
						<h4>
							Informaci칩n b치sica 2/2
						</h4>
						<pre data-id="code-animation"><code>
			# Metadata finder
			metafinder -d "target.tld" -l 10 -go -bi -ba -o path
			
			# Email finder
			emailfinder -d "target.tld"
			
			# Users/Employees
			python3 crosslinked.py -f '{first}.{last}@domain.com' company
			site:linkedin.com/in "domain.com" # Dork

			# Data breaches for free
			https://breachdirectory.org/
			https://hashes.com/en/decrypt/hash</code></pre>
					</section>
					<section>
						<br>
						<br>
						<h4>
							<a href="https://www.crunchbase.com/">Crunchbase</a>
						</h4>
						<ul>
							<li style="font-size: 0.7em;">Fusiones y adquisiciones</li>
							<li style="font-size: 0.7em;">Dominios asociados</li>
							<li style="font-size: 0.7em;">Informaci칩n hist칩rica</li>
							<li style="font-size: 0.7em;">Otros: tech stack, supply chain</li>
						</ul>
						<p>
							<img src="https://media.giphy.com/media/l1LcbR6oWTJkJllOE/giphy.gif" width="60%" height="auto"/>
						</p>
					</section>
					<section>
						<br>
						<h4>
							ASN recon
						</h4>
						<ul>
							<li style="font-size: 0.7em;">Detectar ASN dedicados</li>
							<li style="font-size: 0.7em;">Expandir bloques de IPs</li>
							<li style="font-size: 0.7em;">Proveedor de hosting</li>
							<li style="font-size: 0.7em;">Mapear estructura de red</li>
						</ul>
						<pre data-id="code-animation"><code>
	# Manual
	bgp.he.net, ipinfo.io, asnlookup.com
	
	# Fetch info from ASN
	asnmap -i 1.3.3.7 -org GOOGLE -d facebook.com -a AS3941
	amass intel -org "COMPANY"
						</code></pre>
					</section>
					<section>
						<h4>
							Registrants / reverse whois
						</h4>
						<p>Owner name, company name, email o palabras clave, es una relaci칩n que requiere investigar recursivamente debido a que las empresas usan distintos emails y nombres para registrar sus dominios.</p>
						<p>Dif칤cil de automatizar o recuperar sin interacci칩n desde cli. Altas probabilidades de salirse de scope.</p>
						<ul>
							<li style="font-size: 0.7em;"><a href="https://viewdns.info/">Viewdns</a></li>
							<li style="font-size: 0.7em;"><a href="https://www.whoxy.com/">Whoxy</a></li>
							<li style="font-size: 0.7em;"><a href="https://iqwhois.com/">iqwhois</a></li>
							<li style="font-size: 0.7em;"><a href="https://www.whoisxmlapi.com/">WhoisXMLAPI</a></li>
						</ul>
					</section>
					<section>
						<h4>
							Favicon Hash
						</h4>
						<p>칔til para descubrir dominios relacionados, requiere el <a href="https://github.com/edoardottt/favirecon">c치lculo</a> del hash del <a href="https://cyberwarzone.com/online-favicon-checksum-tool/#">favicon</a> y tener cuenta en Shodan, ojo a redise침os o logotipos antiguos 游땦</p>
						<pre data-id="code-animation"><code>
				# Shodan query
				http.favicon.hash:FAVICONHASH

				# Tool
				python3 favUp.py -wl web_list.txt -sc
						</code></pre>
					</section>
					<section>
						<h4>
							Recursividad
						</h4>
						<img src="https://media.giphy.com/media/agSmzrhrXNiWA/giphy.gif" width="25%" height="auto"/>
					</section>
				</section>
				<section>
					<h2>Descubrimiento de activos</h2>
					<section>
						<p>
							<img src="https://media.giphy.com/media/YlAuPqtjwlSyzy8PZU/giphy-downsized-large.gif" width="auto" height="auto"/>
						</p>
					</section>
					<section>
						<h4>
							Enumeraci칩n pasiva de subdominios 1/4
						</h4>
						<p>Forma m치s f치cil y r치pida de recuperar subdominios, info desactualizada, modelo de gasto de cr칠ditos/tokens por consulta en la mayor칤a de servicios.</p>
						<ul>
							<li style="font-size: 0.7em;">Datos de servicios de terceros
								<ul>
									<li style="font-size: 0.8em;">Fuentes (<a href="https://securitytrails.com/">SecurityTrails</a>, <a href="https://censys.io/">Censys</a>, ... <a href="https://docs.google.com/spreadsheets/d/1ssuiovzgvFH2aTK-ymrxy2VezvHw5fnvXxBMH3Jnok4/edit?usp=sharing">+200</a>)</li>
									<li style="font-size: 0.8em;">Tools (<a href="https://github.com/OWASP/Amass">Amass</a>, <a href="https://github.com/projectdiscovery/subfinder">Subfinder</a>, <a href="https://github.com/tomnomnom/assetfinder">Assetfinder</a>)</li>
								</ul>
							</li>
							<li style="font-size: 0.7em;"><a href="https://crt.sh/">Transparencia de certificados</a></li>
							<li style="font-size: 0.7em;">C칩digo en proveedores de control de versions (GitHub, GitLab, etc.)</li>
						</ul>
					</section>
					<section>
						<h4>
							Enumeraci칩n pasiva de subdominios 2/4
						</h4>
						<pre data-id="code-animation"><code>
					# Amass passive data fetch
					amass enum -passive -d target.tl	
					subfinder -d target.tl
					
					# Ctfr subdomain search on crtsh
					python3 ctfr.py -d target.tl
					
					# Subdomains from Github
					github-subdomains -d target.tld -t tokens.txt

					# Subdomains from GitLab
					gitlab-subdomains -d target.tld
						</code></pre>
					</section>
					<section>
						<h4>
							Enumeraci칩n pasiva de subdominios 3/4
						</h4>
						<ul>
							<li style="font-size: 0.7em;">Registros DNS</li>
							<li style="font-size: 0.7em;"><a href="https://builtwith.com/">Relaciones</a><a href="https://osint.sh/analytics/"> cruzadas</a> <a href="https://site-overview.com/">Analytics</a>
								<ul>
									<li style="font-size: 0.8em;">Google Analytics</li>
									<li style="font-size: 0.8em;">Google Tag Manager</li>
									<li style="font-size: 0.8em;">Facebook Pixel Tag</li>
									<li style="font-size: 0.8em;">NewRelic</li>
								</ul>
							</li>
						</ul>
					</section>
					<section>
						<h4>
							Enumeraci칩n pasiva de subdominios 4/4
						</h4>
						<pre data-id="code-animation"><code>
				# Fetching DNS records with dnsx
				cat subs.txt | dnsx -cname -ns -mx -soa -resp					
				
				# Analytics from BuiltWith and HackerTarget
				cat file.txt | analyticsrelationships 					
				
				# Analytics from SpyOnWeb, site-overview.com
				# 	osint.sh and HackerTarget
				udon -silent -json -s UA-33427076 | jq -c
						</code></pre>
					</section>
					<section>
						<h4>Enumeraci칩n activa de subdominios 1/3</h4>
						<p>Alto coste en tiempo y recursos, pero resultados 칰nicos y valiosos</p>
						<p>Requisitos</p>
							<ul>
								<li style="font-size: 0.7em;"><a href="https://github.com/trickest/resolvers/blob/main/resolvers.txt">Resolvers?</a></li>
								<li style="font-size: 0.7em;"><a href="https://github.com/six2dez/resolvers_reconftw/blob/main/resolvers_trusted.txt">Trusted resolvers???</a></li>
								<li style="font-size: 0.7em;">Resoluci칩n DNS en masa (a.k.a. <a href="https://github.com/blechschmidt/massdns">massdns</a>)</li>
								<li style="font-size: 0.7em;">Wordlists, gen칠ricas o espec칤ficas</li>
							</ul>
					</section>
					<section>
						<br>
						<br>
						<h4>Enumeraci칩n activa de subdominios 2/3</h4>
							<ul>
								<li style="font-size: 0.7em;">Fuerza bruta con <a href="https://gist.github.com/six2dez/0e07fd3461338374cc3ef942e1e9ddaf">wordlists</a> gen칠ricas</li>
								<li style="font-size: 0.7em;"><a href="https://gist.github.com/six2dez/942b01af47204958045e7c392c250c86">Permutaciones</a>
									<ul>
										<li style="font-size: 0.8em;">Generaci칩n de wordlists</li>
										<li style="font-size: 0.8em;">An치lisis de reglas regex</li>
										<li style="font-size: 0.8em;">IA???</li>
									</ul>
								</li>
							</ul>
							<pre data-id="code-animation"><code>
		# Gotator wordlist generation
		gotator -sub subdomains.txt -perm permutations.txt \
		-depth 1 -numbers 5 -mindup -adv -md > permutations.txt

		# Regulator
		python3 main.py -t target.tld -f subdomains.txt -o output.rules
							</code></pre>
					</section>
					<section>
						<br>
						<h4>
							Enumeraci칩n activa de subdominios 3/3
						</h4>
						<pre data-id="code-animation"><code>
	# Resolvers generation
	dnsvalidator -tL https://public-dns.info/nameservers.txt \
	-thread 200 > resolvers.txt
	
	# DNS resolution
	puredns bruteforce wordlist.txt target.com \
	-r resolvers.txt --resolvers-trusted res_trusted.txt \
	-l 1000 --wildcard-tests 10 -w output.txt

	# Amass
	amass enum -df doms.txt -w subs.txt -aw perms.txt \
	-rf resolvers.txt -trf res_trust.txt -trqps 400
						</code></pre>
						<p style="font-size: 0.7em;">丘멆잺 Puedes acabar DOSeando el objetivo</p>
					</section>
					<section>
						<h4>
							Other techniques
						</h4>
						<ul>
							<li style="font-size: 0.7em;">An치lisis de certificados x509</li>
							<li style="font-size: 0.7em;">DNS <a href="https://www.securesystems.de/blog/enhancing-subdomain-enumeration-ents-and-noerror/">NOERROR</a> (subdominios anidados)</li>
						</ul>
						<pre data-id="code-animation"><code>
			# x509 subdomain extraction
			cat subs.txt | tlsx -san -cn -silent -r											
			
			# DNS NOERROR
			echo "random.target.tld" | dnsx -rcode noerror,nxdomain
			dnsx -d target.tld -rcode noerror -w wordlist.txt
							</code></pre>
					</section>
					<section>
						<br>
						<br>
						<h4>
							Recursividad
						</h4>
						<img src="https://media.giphy.com/media/agSmzrhrXNiWA/giphy.gif" width="auto" height="auto"/>
					</section>
				</section>
				<section>
					<h2>Escaneo de puertos & descubrimiento de servicios</h2>
					<section>
						<br>
						<br>
						<br>
						<p>
							<img src="https://media.giphy.com/media/xCwYFe19SldXLrJlwm/giphy.gif" width="auto" height="auto"/>
						</p>
					</section>
					<section>
						<br>
						<br>
						<h4>
							Buscar hosts
						</h4>
						<p>Es esencial resolver las IP para evitar resoluciones DNS innecesarias al escanear puertos y/o escanear el mismo host m치s de una vez</p>
						<ul>
							<li style="font-size: 0.7em;">Resoluci칩n DNS de las etapas anteriores</li>
							<li style="font-size: 0.7em;">Obtener IPs a partir de CIDRs o ASN</li>
						</ul>
						<pre data-id="code-animation"><code>
				# Get A/AAAA records from subdomains
				dnsx -a -aaaa -resp -silent -l subdomains.txt
				
				# Expand CIDRs/ASN
				echo "ASD_OR_CIDR" | mapcidr -silent
						</code></pre>
					</section>
					<section>
						<br>
						<h4>
							Detecci칩n de servicios en la nube
						</h4>
						<p style="font-size: 0.7em;"><a href="https://cdn.nuclei.sh/">Rangos de IPs en la nube, WAFs, CDNs</a></p>
						<p>El objetivo es evitar escaneos de puertos innecesarios y evitar baneos o bloqueos.</p>
						<pre data-id="code-animation"><code>
								# WAF and CDN detection
								cat list.txt | ipcdn -v

								# Cloud detection by bruteforce
								python3 cloud_enum.py -k keyword
						</code></pre>
					</section>
					<section>
						<h4>
							Escaneo de puertos pasivo y activo
						</h4>
						<ul>
							<li style="font-size: 0.7em;">Pasivo: Shodan cli/smap
								<ul>
									<li style="font-size: 0.8em;">R치pido</li>
									<li style="font-size: 0.8em;">Sin interacci칩n con el target</li>
									<li style="font-size: 0.8em;">Desactualizado</li>
								</ul>
							</li>
							<li style="font-size: 0.7em;">Activo: Masscan/nmap
								<ul>
									<li style="font-size: 0.8em;">Depende de las opciones, pero m치s lento en general</li>
									<li style="font-size: 0.8em;">M치s ruidoso ya que requiere interacci칩n con el target</li>
									<li style="font-size: 0.8em;">Datos en tiempo real</li>
								</ul>
							</li>
						</ul>
					</section>
					<section>
						<br>
						<h4>
							Ejemplos de escaneos de puertos
						</h4>
						<pre data-id="code-animation"><code>
						# Passive ports scan
						smap -iL targets.txt
						shodan host 10.X

						# Active ports scan
						masscan 10.X.X.X -p1-1000
						nmap -iL targets.txt
						nmap -iL targets.txt -sV --script vulners 
							--script-args mincvss=7.0
						</code></pre>

					</section>
					<section>
						<br>
						<h4>
							Expandir pasos anteriores
						</h4>
						<p style="font-size: 0.7em;">Reverse DNS records / PTR</p>
						<p style="font-size: 0.7em;">丘멆잺 Peligro de salirse de scope (cloud, hosting compartido, etc.)</p>
						<pre data-id="code-animation"><code>
				# PTR records
				cat iplist.txt | dnsx -ptr -retry 3 -silent -resp
						</code></pre>
					</section>
				</section>
				<section>
					<h2>Inspecci칩n de las tecnolog칤as</h2>
					<section>
						<br>
						<br>
						<br>
						<p>
							<img src="https://media.giphy.com/media/1uyFaGpt2ilmE/giphy-downsized-large.gif" width="auto" height="auto"/>
						</p>
					</section>
					<section>
						<h4>
							Versiones de software
						</h4>
						<ul>
							<li style="font-size: 0.7em;">칔til para etapas posteriores
								<ul>
									<li style="font-size: 0.8em;">Ataques espec칤ficos</li>
									<li style="font-size: 0.8em;">Vulnerabilidades conocidas</li>
								</ul>
							</li>
							<li style="font-size: 0.7em;">Ayuda para priorizar</li>
							<li style="font-size: 0.7em;">Nivel de actualizaciones</li>
						</ul>
					</section>
					<section>
						<h4>
							Banner grabbing / servicios custom
						</h4>
						<ul>
							<li style="font-size: 0.7em;">Igual que las versiones de software</li>
							<li style="font-size: 0.7em;">OS Fingerprinting</li>
							<li style="font-size: 0.7em;">Servicios custom o desconocidos == echar un ojo</li>
						</ul>
					</section>
					<section>
						<br>
						<br>
						<br>
						<h4>
							CMS, frameworks, WAF
						</h4>
						<p style="font-size: 0.7em;">Historial de vulnerabilidades conocidas en diferentes CMS (WordPress, Drupal), Frameworks (Symfony, Laravel) y bypasses seg칰n el WAF</p>
						<pre data-id="code-animation"><code>
			# Web tech detection
			httpx -title -server -tech-detect -cdn -l list.txt
			
			# CMS detection
			python3 cmseek.py -l tartget_list.txt
			
			# WAF detection
			wafw00f -l tartget_list.txt
						</code></pre>
					</section>
					<section>
						<br>
						<br>
						<h4>
							Inpecci칩n visual / web screenshooting
						</h4>
						<p style="font-size: 0.7em;">Ayuda a filtrar miles de capturas de pantalla y la mayor칤a de las herramientas proporcionan informes</p>
						<p style="font-size: 0.7em;">Podemos aprovecharnos de la IA para clasificar los sitios seg칰n su aspecto</p>
						<pre data-id="code-animation"><code>
			# Web screenshoting
			gowitness file -f sites.tx			

			# Classify based on given pretrained AI model
			python3 eyeballer.py --weights model.h5 evaluate /path/
						</code></pre>
					</section>
				</section>
				<section>
					<h2>Low hanging fruits</h2>
					<section>
						<br>
						<br>
						<p>
							<img src="https://media.giphy.com/media/0r51Zmo72WICswWagi/giphy.gif" width="auto" height="auto"/>
						</p>
					</section>
					<section>
						<h4>
							CVE's and vulnerabilidades conocidas
						</h4>
						<ul>
							<li style="font-size: 0.7em;">CVE Trends</li>
							<li style="font-size: 0.7em;">Credenciales por defecto</li>
							<li style="font-size: 0.7em;">Vulnerabilidades t칤picas de una m치quina Easy de HTB</li>
						</ul>
					</section>
					<section>
						<br>
						<br>
						<h4>
							Nuclei
						</h4>
						<ul>
							<li style="font-size: 0.7em;">Reemplazo FOSS para soluciones comerciales de esc치neo de vulnerabilidades</li>
							<li style="font-size: 0.7em;">Basado en plantillas</li>
							<li style="font-size: 0.7em;">Plantillas dise침adas por la comunidad</li>
							<li style="font-size: 0.7em;">Desde detecci칩n de software hasta explotaci칩n de vulns cr칤ticas</li>
							<li style="font-size: 0.7em;">Facilidad para escribir tus propias plantillas</li>
						</ul>
						<pre data-id="code-animation"><code>
						# Fetch latest templates
						nuclei -ut
						
						# Scan horizontally for specific CVE
						cat targets.txt | nuclei -id CVE-2023-1337
						</code></pre>
					</section>
					<section>
						<h4>
							Archivos comunes con info sensible
						</h4>
						<ul>
							<li style="font-size: 0.7em;">Revelaci칩n de credenciales</li>
							<li style="font-size: 0.7em;">Informaci칩n interna confidencial</li>
							<li style="font-size: 0.7em;">Informaci칩n cr칤tica sobre otros activos</li>
							<li style="font-size: 0.7em;"><a href="https://github.com/six2dez/OneListForAll/blob/main/onelistforallmicro.txt">Archivos interesantes</a>: .conf,.env,.sftp_config,etc</li>
							<li style="font-size: 0.7em;">PII</li>
						</ul>
					</section>
					<section>
						<br>
						<h4>
							Subdomain takeovers
						</h4>
						<p>Registros DNS mal configurados que apuntan a servicios de terceros que pueden ser reclamados por cualquiera.
						<ul>
							<li style="font-size: 0.7em;">Activos olvidados de la empresa</li>
							<li style="font-size: 0.7em;">Principalmente subdominios ocultos en niveles profundos</li>
							<li style="font-size: 0.7em;">Impacto en la reputaci칩n de la marca y en los datos de los usuarios</li>
							<li style="font-size: 0.7em;">La mayor칤a de las veces requiere una suscripci칩n de pago</li>
							<li style="font-size: 0.7em;"><a href="https://github.com/projectdiscovery/nuclei-templates/tree/main/takeovers">Nuclei templates FTW</a></li>
							<li style="font-size: 0.7em;">Fix: Cuida tus registros DNS, limpiezas peri칩dicas</li>
						</ul>
					</section>
				</section>
				<section>
					<h2>Sacando las armas</h2>
					<section>
						<p>
							<img src="https://media.giphy.com/media/e2Qlt1gyZmFAbOhly4/giphy.gif" width="auto" height="auto"/>
						</p>
					</section>
					<section>
						<h4>
							Fuerza bruta en login/creds por defecto
						</h4>
						<p>Nuclei tienen una gran biblioteca de plantillas con credenciales predeterminadas en funci칩n de la tecnolog칤a en configuraciones por defecto.
						Las plantillas de nuclei son bastante sencillas de crear por tu cuenta en caso de que quieras 
						probar una gran cantidad de instancias de una aplicaci칩n espec칤fica.</p>

						<p>Otras opciones incluyen tener a mano una lista de crendenciales y ejecutarla con ffuf. Esto requiere conocer un poco m치s
						el contexto de la aplicaci칩n (igual que para crear una plantilla de Nuclei) y no es f치cil automatizar globalmente.</p>
					</section>
					<section>
						<h3>
							Recolectores de urls: Crawler
						</h3>
						<h4>Katana</h4>
						<p style="font-size: 0.7em;">Un crawler que devuelve los enlaces encontrados en el sitio objetivo. Tiene una gran cantidad de opciones de configuraci칩n
						para no salirse de scope, as칤 como incluir cookies de autenticaci칩n o cualquier tipo de headers. Adem치s tiene un modo "headless"
						que permite interpretar el DOM o JS din치micos complejo como si se tratase de un navegador web m치s.
						</p>
						<pre><code>katana -list url_list.txt -jc -kf -cs target.tld -ef jpg,png</code></pre>
					</section>
					<section>
						<br>
						<br>
						<h3>
							Recolectores de urls: Pasivo / hist칩rico
						</h3>
						<h4>gau / waymore / github-endpoints</h4>
						<p style="font-size: 0.7em;">Extraer urls de un dominio desde diferentes servicios de terceros, como WaybackMachine, VirusTotal o URLScan. A veces es m치s 칰til que los crawlers/spiders porque pueden contener par치metros GET y darnos una idea de c칩mo se usan los endpoints, incluso pueden revelar informaci칩n sensible</p>
						<pre><code>		# gau
		cat sites.txt | gau
		# waymore
		python3 waymore.py -i webs.txt -mode U -f -O file.txt
		# github-endpoints
		github-endpoints -d target.tld -t key.txt -o output.txt</code></pre>
					</section>
					<section>
						<h4>
							An치lisis URLs (<a href="https://github.com/1ndianl33t/Gf-Patterns">patrones GF</a>)
						</h4>
						<p>Wrapper de grep escrito en Go para la clasificaci칩n de urls y la b칰squeda de patrones potencialmente vulnerables</p>
						<ul>
							<li style="font-size: 0.7em;">SSRF</li>
							<li style="font-size: 0.7em;">SQLi</li>
							<li style="font-size: 0.7em;">base64</li>
							<li style="font-size: 0.7em;">Clasificaci칩n por extensiones</li>
						</ul>
					</section>
					<section>
						<h4>
							Wordlists contextuales: basadas en el target
						</h4>
						<p>Se pueden utilizar herramientas de TomNomNom como <a href="https://github.com/tomnomnom/unfurl">unfurl</a>
							para extraer partes interesantes de las urls y crear la base de una wordlist personalizada. Normalmente, estas partes interesantes incluyen par치metros, valores, rutas, etc.</p>

						<p>Existen algunas herramientas antiguas y fiables como <a href="https://github.com/digininja/CeWL">CeWL</a> para la generaci칩n de listas de palabras basadas en objetivos a partir 
						de todo el contenido del sitio.</p>
					</section>
					<section>
						<h4>
							Wordlists contextuales: basadas en la tecnolog칤a
						</h4>
						<p>OneListForAll tiene una buena colecci칩n de <a href="https://github.com/six2dez/OneListForAll/tree/main/dict">wordlists separadas por tecnolog칤as</a>.</p>
						<p>Assetnote <a href="https://wordlists.assetnote.io/">tiene una colecci칩n</a> de wordlists espec칤ficamente elaboradas y basadas en el contexto.</p>
					</section>
					<section>
						<h4>
							Esc치neres de vulnerabilidades espec칤ficos
						</h4>
						<p>Herramientas creadas en torno a una tecnolog칤a espec칤fica centradas en diferentes vulnerabilidades concretas</p>
						<ul>
							<li style="font-size: 0.7em;">WPScan</li>
							<li style="font-size: 0.7em;">CMSeek</li>
							<li style="font-size: 0.7em;">aem-hacker</li>
							<li style="font-size: 0.7em;">sret</li>
						</ul>
					</section>
					<section>
						<h4>
							An치lisis JS
						</h4>
						<p>Todav칤a hay mucho margen de mejora en este aspecto, ya que el an치lisis sint치ctico y la renderizaci칩n de JS son dif칤ciles de automatizar</p>
						<ul>
							<li style="font-size: 0.7em;"><a href="https://github.com/w9w/JSA">B칰squeda</a> de JS <a href="https://github.com/xnl-h4ck3r/xnLinkFinder">recursiva</a></li>
							<li style="font-size: 0.7em;">Recolectores de endpoints</li>
							<li style="font-size: 0.7em;"><a href="https://github.com/projectdiscovery/nuclei-templates/tree/main/exposures">Secretos en JS</a></li>
						</ul>
					</section>
					<section>
						<h3>Responders: interactsh</h3>
						<p>Est치 disponible como soluci칩n hosteada por PDiscovery, pero se le saca mucho m치s partido si se hostea uno propio. 
						Adem치s cuando se trata de posibles vulnerabilidades, es importante que t칰 seas el 칰nico propietario de los datos</p>
						<p><a href="https://github.com/projectdiscovery/interactsh">https://github.com/projectdiscovery/interactsh</a></p>
						<p>Para hostear el server se necesita un servidor (VPS) con una direcci칩n IP est치tica y un nombre de dominio.</p>
						<p>En el contexto de pentesting web, se utiliza a menudo s칩lo como callback DNS para capturar peticiones SSRF.</p>
					</section>
					<section>
						<h3>Responders: XSSHunter</h3>
						<p>Esta es una gran herramienta para gestionar eficientemente vulnerabilidades XSS, especialmente para blind XSS. El XSSHunter original
						fue descontinuado hace poco y ha sido sustituido por un fork ligeramente modificado y hosteada por Trufflesec.</p>
						<p>Para subrayar a칰n m치s que "debes hostearlo por ti mismo" (tanto la instancia como la propiedad de los datos), recientemente ha habido controversia
						con Trufflesec por farmear y publicar informaci칩n de la base de datos de su version hosteada, supuestamente para estad칤sticas de uso.</p>
						<p>OG: <a href="https://github.com/mandatoryprogrammer/xsshunter-express">https://github.com/mandatoryprogrammer/xsshunter-express</a></p>
						<p>Trufflesec fork: <a href="https://github.com/trufflesecurity/xsshunter">https://github.com/trufflesecurity/xsshunter</a></p>
					</section>
					<section>
						<h4>
							Web fuzzing avanzado
						</h4>
						<p>Ffuf es una gran herramienta para este prop칩sito. Est치 dise침ado para ser muy vers치til, rollo navaja suiza para web fuzzing.</p>
						<img src="ffuf_logo.png" style="width: 40%;margin: -30px;">
						<p>A continuaci칩n se mostrar치n algunos ejemplos de escaneos automatizados que se pueden hacer con ffuf, pero se puede hacer mucho m치s.
							Para conocer m치s a fondo las distintas opciones disponibles, p치sate por la <a href="https://github.com/ffuf/ffuf/wiki">documentaci칩n de ffuf</a>.</p>

					</section>
					<section>
						<h4>Advanced web fuzzing: Extracci칩n de credenciales</h4>
						<p>Ffuf proporciona una manera de a침adir <a href="https://github.com/ffuf/ffuf/wiki/Scraper">scraper rules</a>.Son archivos json que se pueden guardar en $HOME/.config/ffuf/scraper/</p>
						<p>Un archivo de ejemplo que puede utilizarse en el taller est치 en el <a href="https://github.com/hconrecon23/workshop/blob/master/aws_creds.json">repo</a>. 칄stas reglas se aplican pasivamente a todos los escaneos de ffuf si guardas el archivo en el directorio global de scrapers. Para un solo uso, se puede hacer referencia a un archivo de scraper con el par치metro -scraperfile.</p>
						<pre data-id="code-animation"><code># -mc 999 deshabilita la salida hasta que el scraper salte
ffuf -w all_urls.txt -u FUZZ -mc 999 \
	   -scraperfile aws_creds.json</code></pre>
					</section>
					<section>
						<h4>
							Advanced web fuzzing: Virtualhosts
						</h4>
						<p>Se pruebam todos los nombres de host contra todos los targets web y devuelve todos los vhosts que reciben respuesta de
						de CDNs/load balancers. Esto puede llevar a veces a divertidas fallos de configuraci칩n.</p>
						<pre data-id="code-animation"><code>ffuf -w hostnames.txt:VHOST -w hostnames.txt:DOMAIN \
				-u https://DOMAIN -H "Host: VHOST" -ac -ach
						</code></pre>
					</section>
					<section>
						<br>
						<h4>
							Advanced web fuzzing: Headers (blind)
						</h4>
						<p>Se combina una lista de headers junto con una lista de payloads para encontrar diferentes vulnerabilidades.
						Puedes ir a lo loco e incluir todo en la misma petici칩n pero ser칤a m치s complicado encontrar el payload bueno.</p>
						<p>Normalmente esto lleva a XSS (a trav칠s de paneles administrativos normalmente), proxies inversos mal configurados, balanceadores de carga, etc.</p>
						<p>Es interesante lanzar una ejecuci칩n por cada tipo de vuln. Por ejemplo:
						filtrado basado en el tiempo para time-based SQLi</p>
						<pre data-id="code-animation"><code>ffuf -w headernames.txt:HEADERNAME -w payloads.txt:PAYLOAD \
				-w hostnames.txt:TARGET \
				-u https://TARGET \
				-H "HEADERNAME: PAYLOAD"</code></pre>
					</section>
					<section>
						<h4>
							Advanced web fuzzing: SSTI
						</h4>
						<p>Puedes crear tu propia wordlist de payloads SSTI f치ciles de identificar. Un buen recurso para empezar ser칤a la p치gina de 
						<a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection">PayloadsAllTheThings</a>
							sobre SSTI.</p>
						<p>Aseg칰rate de que el c치lculo te devuelve algo 칰nico y f치cil de contrastar. El t칤pico {{7*7}} puede llevar a un mont칩n
						de falsos positivos ;)</p>
						<pre data-id="code-animation"><code>ffuf -w ssti_payloads.txt:SSTI -w get_params.txt:GETPARAM \
				-w hostnames.txt:TARGET \
				-u https://TARGET/?GETPARAM=SSTI \
				-mr 'result_of_your_unique_calculation_here'</code></pre>
					</section>
					<section>
						<h4>
							Advanced web fuzzing: LFI
						</h4>
						<p>Puedes seguir el mismo principio que con los SSTI. En este caso interesa lanzar una ejecuci칩n de ffuf por cada payload
						en caso de que est칠s intentando leer diferentes archivos del filesystem.</p>
						<p>Puedes usar la 
							<a href="https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/LFI/LFI-Jhaddix.txt">wordlist de LFI </a>
						de Jhaddix, inclu칤da en SecLists.</p>
						<p>En el siguiente ejemplo se usa la wordlist de LFI con diferentes t칠cnicas para leer /etc/passwd</p>
						<pre data-id="code-animation"><code>ffuf -w lfi_payloads.txt:LFI -w get_params.txt:GETPARAM \
				-w hostnames.txt:TARGET \
				-u https://TARGET/?GETPARAM=LFI \
				-mr 'root:x:0:0:root'</code></pre>
					</section>
					<section>
						<h4>
							Blind SSRF payloads
						</h4>
						<p>ffuf 2.0 tiene una funci칩n de mapeo inverso llamada <b>FFUFHASH</b> que permite a침adir un placeholder 칰nico
						para payloads de blind SSRF. Esto funciona especialmente bien con interactsh. En el siguiente ejemplo el
						dominio de interactsh ser칤a <b>iash.evil.com</b>:</p>
						<pre data-id="code-animation"><code>ffuf -w params.txt -u \
		https://target.tld/?FUZZ=%2F%2FFFUFHASH.iash.evil.com</code></pre>
					</section>
				</section>
				<section>
					<h2>Escalando</h2>
					<section>
						<img src="https://media.giphy.com/media/6bh9FTTEKdtZe/giphy.gif" />
					</section>
					<section>
						<img src="axiom_banner.png" style="width: 50%;"/>
						<ul>
                            <li>La herramienta divide las wordlists y otros m칠todos de entrada entre las instancias de la flota</li>
							<li>Los resultados se recuperan y se vuelven a unir en la m치quina controladora</li>
							<li><a href="https://github.com/pry0cc/axiom">https://github.com/pry0cc/axiom</a></li>
                        </ul>
					</section>
					<section>
						<h4>Axiom</h4>
						<pre><code>
							# Building the image
							axiom-build
							
							# Spin up the fleet
							axiom-fleet "1337squadron" -i 50
							
							# Scanning
							axiom-scan input.txt -m ffuf -o output.txt 

							# Deleting the fleet
							axiom-rm -f "\*"
						</code></pre>
						<p style="font-size: 0.7em;">丘멆잺 Alto riesgo de DDOS</p>
					</section>
					<section>
						<img src="serverless.jpeg" style="width: 30%"/>
						<ul>
                            <li>Escala infinitamente, pero puede ser caro</li>
							<li>Levanta miles de funciones AWS Lambda para ejecutar la tarea de forma extremadamente r치pida</li>
							<li><a href="https://github.com/fyoorer/ShadowClone">https://github.com/fyoorer/ShadowClone</a></li>
                        </ul>
					</section>
					<section>
						<br>
						<h4>Shadowclone</h4>
						<ul>
                            <li>Config: <a href="https://github.com/fyoorer/ShadowClone/wiki">https://github.com/fyoorer/ShadowClone/wiki</a></li>
							<li>Nota: las pol칤ticas de AWS obligan incluir tambi칠n el rol "iam:PassRole"</li>
							<li>La wiki est치 un poco desactualizada pero los siguientes comandos deber칤an funcionar:</li>
                        </ul>
						<pre><code># build your container
lithops runtime build sc-runtime -f Dockerfile

# deploy it with 512Mb memory and 300sec timeout
lithops runtime deploy --memory 512 --timeout 300 sc-runtime</code></pre>
						<ul>
                            <li style="font-size: 0.7em;">1m 40s para escanear 700k websites con una sola plantilla</a></li>
							<li style="font-size: 0.7em;">10m para mapear las tecnolog칤as de 700k websites</a></li>
						</ul>
					</section>
				</section>
				<section>
					<h2>Automatizaci칩n</h2>
					<section>
						<h4>Uniendo todas las piezas</h4>
						<img src="automation.gif" />
					</section>
					<section>
                        <h4>Scripting</h4>
                        <p style="font-size: 0.7em;">Para permitir una f치cil extensi칩n y construcci칩n iterativa de la automatizaci칩n lo mejor es utilizar Python o shell scripting.</p>
                        <ul>
                            <li style="font-size: 0.7em;">Beneficios de 游냀
                                <ul>
                                    <li>Capacidad de actuar inmediatamente en funci칩n de los resultados, basado en "eventos"</li>
                                    <li>Facilidad para filtrar los resultados dentro del flujo</li>
                                    <li>M치s control sin amplios conocimientos profundos del lenguaje</li>
                                    <li>Control de trabajos (potencialmente) paralelos</li>
                                </ul>
                            </li>
                            <li style="font-size: 0.7em;">Beneficios de 游냌
                                <ul>
                                    <li>Se empieza extremadamente r치pido</li>
                                    <li>Muchas herramientas de software libre a tu disposici칩n</li>
                                    <li>F치cil de ampliar a칰n m치s con frameworks como Axiom</li>
                                </ul>
                            </li>
                        </ul>
                    </section>
                    <section>
                        <h4>Parseo</h4>
                        <p style="font-size: 0.7em;">JSON est치 hecho para ser le칤do por ordenadores y es tu mejor aliado. La mayor칤a de las herramientas lo soportan de una forma u otra. En general, estar치s tratando con archivos de texto o con JSON.</p>
                        <ul>
                            <li>Python soporta JSON nativamente</li>
                            <li><a href="https://github.com/stedolan/jq">jq</a> es una herramienta CLI impresionante para parsear y filtrar JSON</li>
                            <li>Se puede grepear JSON con <a href="https://github.com/tomnomnom/gron">gron</a></li>
                            <li>O seleccionar partes espec칤ficas de las URL con <a href="https://github.com/tomnomnom/unfurl">unfurl</a></li>
                        </ul>
                    </section>
                    <section>
                        <h4>Piping</h4>
                        <p style="font-size: 0.7em;">Muchas etapas diferentes en el proceso de automatizaci칩n pueden bifurcarse en m칰ltiples subtareas, por lo que a menudo es bueno almacenar los resultados de las etapas anteriores en un archivo temporal. Esto tambi칠n suele ayudar a depurar posibles problemas.</p>
                        <ul>
                            <li>Usa <a href="https://man7.org/linux/man-pages/man1/tee.1.html">tee</a> para a침adir stdout a un archivo mientras tambi칠n se muestra por terminal</li>
                            <li><a href="https://github.com/tomnomnom/anew">anew</a> solo a침ade las nuevas l칤neas al archivo de salida</li>
                        </ul>
                    </section>
                    <section>
                        <h4>Filtrado</h4>
                        <p style="font-size: 0.7em;">Trata de evitar la creaci칩n de tr치fico innecesario, y sobre todo salirte fuera del scope, lo que puede suceder con bastante facilidad. Aseg칰rate de filtrar las entradas que no quieres de tu workflow desde el principio. Esto har치 que tu automatizaci칩n sea m치s r치pida, y causar치 considerablemente menos problemas legales en el futuro ;)</p>
                        <p style="font-size: 0.7em;">Puedes encontrar un ejemplo de un sencillo script en Python que lee l칤neas de stdin (pensadas para ser utilizadas dentro en un pipe) y devuelve s칩lo las urls http(s) dentro del scope <a href="https://github.com/hconrecon23/workshop/blob/master/inscope_http.py">aqu칤</a></p>
                    </section>
					<section>
                        <h4>Frameworks</h4>
                        <p style="font-size: 0.7em;">Conjunto de herramientas y t칠cnicas cuyo objetivo es automatizar todo el proceso de reconocimiento, proporcionando un flujo de trabajo personalizable (o no) para lograr el objetivo.</p>
						<ul>
                            <li><a href="https://github.com/smicallef/spiderfoot">reNgine</a>: web ui, Python, Docker, Postgres DB, yaml workflows, workflows predefinados + posibilidad de custom</li>
							<li><a href="https://github.com/epi052/recon-pipeline">recon-pipeline</a>: cli, Python, sqlite DB, listado de herramientas cerradas, esc치neres predefinidos y posibilicad de customs</li>
                            <li><a href="https://github.com/six2dez/reconftw">reconFTW</a>: cli sin UI (<a href="https://www.youtube.com/watch?v=rsIj7bFx4dk">de momento</a>), archivos de texto, listado cerrado de herramientas y workflow, customizable, Docker, Terraform, integraci칩n con axiom</li>
                        </ul>
                    </section>
				</section>
				<section>
					<h2>Aplicaci칩n pr치ctica</h2>
					<section>
						<img src="https://media.giphy.com/media/3oKIPwoeGErMmaI43S/giphy.gif" width="50%" height="auto"/>
					</section>
					<section>
                        <h4>Soluci칩n personalizada de mapeo de superficies de ataque</h4>
                    </section>
					<section>
                        <h4>Proceso previo al comienzo del pentest</h4>
                    </section>
					<section>
                        <h4>Bug bounty</h4>
                    </section>
				</section>
			</div>
		</div>
		<script src="dist/reveal.js"></script>
		<script src="plugin/zoom/zoom.js"></script>
		<script src="plugin/notes/notes.js"></script>
		<script src="plugin/search/search.js"></script>
		<script src="plugin/markdown/markdown.js"></script>
		<script src="plugin/highlight/highlight.js"></script>
		<script>

			// Also available as an ES module, see:
			// https://revealjs.com/initialization/
			Reveal.initialize({
				controls: true,
				progress: true,
				center: true,
				hash: true,

				// Learn about plugins: https://revealjs.com/plugins/
				plugins: [ RevealZoom, RevealNotes, RevealSearch, RevealMarkdown, RevealHighlight ]
			});

		</script>

	</body>
</html>
